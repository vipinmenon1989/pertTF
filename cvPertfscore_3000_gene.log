[Auto-pin] using GPU 0
{'seed': 42, 'dataset_name': 'pancreatic', 'do_train': True, 'load_model': None, 'GEPC': True, 'ecs_thres': 0.7, 'dab_weight': 0, 'this_weight': 1, 'next_weight': 10, 'n_rounds': 1, 'next_cell_pred_type': 'identity', 'ecs_weight': 1, 'cell_type_classifier': True, 'cell_type_classifier_weight': 1, 'perturbation_classifier_weight': 50, 'perturbation_input': False, 'CCE': False, 'mask_ratio': 0.15, 'epochs': 150, 'n_bins': 51, 'lr': 0.001, 'batch_size': 32, 'layer_size': 32, 'nlayers': 2, 'nhead': 4, 'dropout': 0.4, 'schedule_ratio': 0.99, 'save_eval_interval': 5, 'log_interval': 60, 'fast_transformer': True, 'pre_norm': False, 'amp': True, 'do_sample_in_train': False, 'ADV': False, 'adv_weight': 10000, 'adv_E_delay_epochs': 2, 'adv_D_delay_epochs': 2, 'lr_ADV': 0.001, 'DSBN': False, 'per_seq_batch_sample': False, 'use_batch_label': False, 'schedule_interval': 1, 'explicit_zero_prob': True, 'USE_HVG': True, 'n_hvg': 3000, 'mask_value': -1, 'pad_value': -2, 'pad_token': '<pad>', 'ps_weight': 0, 'max_cells': None, 'max_cells_seed': 1337, 'filter_missing_subcluster': True, 'KEEP_WT_FRAC': 1, 'special_tokens': ['<pad>', '<cls>', '<eoc>'], 'max_seq_len': 3001}
scGPT - INFO - Binning data ...
Initializing PertTFUniDataManager: Creating vocab and mappings...
Initialization complete.
Creating a single train/validation split (test_size=0.2)...
scGPT - INFO - | epoch   1 |  60/4480 batches | lr 0.00100000 | ms/batch 94.16 | loss  0.00 | mse 185.85 | mre 472574.26 |mse_next 185.85 | mre_next 472574.26 |cls  3.04 | pert  3.08 | ps  0.00 |gepc 167.18 |gepc_next 171.76 |
scGPT - INFO - | epoch   1 | 120/4480 batches | lr 0.00100000 | ms/batch 47.93 | loss  0.00 | mse 155.62 | mre 3660403.78 |mse_next 155.62 | mre_next 3660403.78 |cls  2.69 | pert  2.54 | ps  0.00 |gepc 118.58 |gepc_next 120.51 |
scGPT - INFO - | epoch   1 | 180/4480 batches | lr 0.00100000 | ms/batch 48.45 | loss  0.00 | mse 119.52 | mre 3052665.80 |mse_next 119.52 | mre_next 3052665.80 |cls  2.65 | pert  2.55 | ps  0.00 |gepc 103.67 |gepc_next 102.66 |
scGPT - INFO - | epoch   1 | 240/4480 batches | lr 0.00100000 | ms/batch 47.78 | loss  0.00 | mse 106.02 | mre 2668960.52 |mse_next 106.02 | mre_next 2668960.52 |cls  2.67 | pert  2.55 | ps  0.00 |gepc 102.29 |gepc_next 101.86 |
scGPT - INFO - | epoch   1 | 300/4480 batches | lr 0.00100000 | ms/batch 48.10 | loss  0.00 | mse 103.65 | mre 2559116.90 |mse_next 103.65 | mre_next 2559116.90 |cls  2.64 | pert  2.54 | ps  0.00 |gepc 100.49 |gepc_next 100.60 |
scGPT - INFO - | epoch   1 | 360/4480 batches | lr 0.00100000 | ms/batch 47.96 | loss  0.00 | mse 102.95 | mre 2569834.88 |mse_next 102.95 | mre_next 2569834.88 |cls  2.62 | pert  2.55 | ps  0.00 |gepc 100.20 |gepc_next 100.53 |
scGPT - INFO - | epoch   1 | 420/4480 batches | lr 0.00100000 | ms/batch 48.11 | loss  0.00 | mse 101.75 | mre 2497979.34 |mse_next 101.75 | mre_next 2497979.34 |cls  2.62 | pert  2.54 | ps  0.00 |gepc 99.28 |gepc_next 100.26 |
scGPT - INFO - | epoch   1 | 480/4480 batches | lr 0.00100000 | ms/batch 47.66 | loss  0.00 | mse 100.36 | mre 2459224.79 |mse_next 100.36 | mre_next 2459224.79 |cls  2.61 | pert  2.52 | ps  0.00 |gepc 97.92 |gepc_next 99.68 |
scGPT - INFO - | epoch   1 | 540/4480 batches | lr 0.00100000 | ms/batch 47.98 | loss  0.00 | mse 100.87 | mre 2474990.05 |mse_next 100.87 | mre_next 2474990.05 |cls  2.65 | pert  2.51 | ps  0.00 |gepc 98.62 |gepc_next 100.65 |
scGPT - INFO - | epoch   1 | 600/4480 batches | lr 0.00100000 | ms/batch 48.75 | loss  0.00 | mse 100.11 | mre 2413714.83 |mse_next 100.11 | mre_next 2413714.83 |cls  2.63 | pert  2.60 | ps  0.00 |gepc 98.16 |gepc_next 100.49 |
scGPT - INFO - | epoch   1 | 660/4480 batches | lr 0.00100000 | ms/batch 47.77 | loss  0.00 | mse 98.76 | mre 2371219.98 |mse_next 98.76 | mre_next 2371219.98 |cls  2.61 | pert  2.58 | ps  0.00 |gepc 96.90 |gepc_next 99.53 |
scGPT - INFO - | epoch   1 | 720/4480 batches | lr 0.00100000 | ms/batch 48.15 | loss  0.00 | mse 99.32 | mre 2385872.39 |mse_next 99.32 | mre_next 2385872.39 |cls  2.62 | pert  2.54 | ps  0.00 |gepc 97.75 |gepc_next 100.19 |
scGPT - INFO - | epoch   1 | 780/4480 batches | lr 0.00100000 | ms/batch 48.23 | loss  0.00 | mse 99.43 | mre 2407100.08 |mse_next 99.43 | mre_next 2407100.08 |cls  2.61 | pert  2.55 | ps  0.00 |gepc 97.88 |gepc_next 100.22 |
scGPT - INFO - | epoch   1 | 840/4480 batches | lr 0.00100000 | ms/batch 47.64 | loss  0.00 | mse 98.66 | mre 2386958.12 |mse_next 98.66 | mre_next 2386958.12 |cls  2.56 | pert  2.45 | ps  0.00 |gepc 97.53 |gepc_next 99.91 |
scGPT - INFO - | epoch   1 | 900/4480 batches | lr 0.00100000 | ms/batch 48.88 | loss  0.00 | mse 98.95 | mre 2359510.04 |mse_next 98.95 | mre_next 2359510.04 |cls  2.56 | pert  2.51 | ps  0.00 |gepc 97.84 |gepc_next 100.18 |
scGPT - INFO - | epoch   1 | 960/4480 batches | lr 0.00100000 | ms/batch 48.09 | loss  0.00 | mse 99.02 | mre 2373911.26 |mse_next 99.02 | mre_next 2373911.26 |cls  2.60 | pert  2.47 | ps  0.00 |gepc 98.27 |gepc_next 100.43 |
scGPT - INFO - | epoch   1 | 1020/4480 batches | lr 0.00100000 | ms/batch 48.42 | loss  0.00 | mse 99.41 | mre 2387200.82 |mse_next 99.41 | mre_next 2387200.82 |cls  2.53 | pert  2.57 | ps  0.00 |gepc 98.59 |gepc_next 100.47 |
scGPT - INFO - | epoch   1 | 1080/4480 batches | lr 0.00100000 | ms/batch 48.24 | loss  0.00 | mse 99.12 | mre 2365659.21 |mse_next 99.12 | mre_next 2365659.21 |cls  2.51 | pert  2.52 | ps  0.00 |gepc 98.79 |gepc_next 99.72 |
scGPT - INFO - | epoch   1 | 1140/4480 batches | lr 0.00100000 | ms/batch 47.74 | loss  0.00 | mse 97.80 | mre 2328749.27 |mse_next 97.80 | mre_next 2328749.27 |cls  2.48 | pert  2.52 | ps  0.00 |gepc 97.22 |gepc_next 98.85 |
scGPT - INFO - | epoch   1 | 1200/4480 batches | lr 0.00100000 | ms/batch 47.95 | loss  0.00 | mse 97.93 | mre 2368483.50 |mse_next 97.93 | mre_next 2368483.50 |cls  2.50 | pert  2.49 | ps  0.00 |gepc 98.05 |gepc_next 98.91 |
scGPT - INFO - | epoch   1 | 1260/4480 batches | lr 0.00100000 | ms/batch 48.11 | loss  0.00 | mse 97.94 | mre 2336057.91 |mse_next 97.94 | mre_next 2336057.91 |cls  2.45 | pert  2.48 | ps  0.00 |gepc 98.26 |gepc_next 98.58 |
scGPT - INFO - | epoch   1 | 1320/4480 batches | lr 0.00100000 | ms/batch 48.04 | loss  0.00 | mse 97.51 | mre 2286334.55 |mse_next 97.51 | mre_next 2286334.55 |cls  2.42 | pert  2.40 | ps  0.00 |gepc 98.19 |gepc_next 98.07 |
scGPT - INFO - | epoch   1 | 1380/4480 batches | lr 0.00100000 | ms/batch 48.13 | loss  0.00 | mse 96.41 | mre 2336907.14 |mse_next 96.41 | mre_next 2336907.14 |cls  2.40 | pert  2.47 | ps  0.00 |gepc 97.50 |gepc_next 97.35 |
scGPT - INFO - | epoch   1 | 1440/4480 batches | lr 0.00100000 | ms/batch 47.99 | loss  0.00 | mse 95.29 | mre 2241066.64 |mse_next 95.29 | mre_next 2241066.64 |cls  2.37 | pert  2.45 | ps  0.00 |gepc 96.92 |gepc_next 96.95 |
scGPT - INFO - | epoch   1 | 1500/4480 batches | lr 0.00100000 | ms/batch 47.98 | loss  0.00 | mse 93.57 | mre 2261629.69 |mse_next 93.57 | mre_next 2261629.69 |cls  2.26 | pert  2.45 | ps  0.00 |gepc 96.59 |gepc_next 97.13 |
scGPT - INFO - | epoch   1 | 1560/4480 batches | lr 0.00100000 | ms/batch 48.50 | loss  0.00 | mse 90.60 | mre 2143225.19 |mse_next 90.60 | mre_next 2143225.19 |cls  2.22 | pert  2.44 | ps  0.00 |gepc 94.77 |gepc_next 96.77 |
scGPT - INFO - | epoch   1 | 1620/4480 batches | lr 0.00100000 | ms/batch 47.68 | loss  0.00 | mse 87.50 | mre 2092416.11 |mse_next 87.50 | mre_next 2092416.11 |cls  2.16 | pert  2.41 | ps  0.00 |gepc 90.98 |gepc_next 96.67 |
scGPT - INFO - | epoch   1 | 1680/4480 batches | lr 0.00100000 | ms/batch 48.06 | loss  0.00 | mse 86.74 | mre 2107993.44 |mse_next 86.74 | mre_next 2107993.44 |cls  2.14 | pert  2.47 | ps  0.00 |gepc 87.54 |gepc_next 94.92 |
scGPT - INFO - | epoch   1 | 1740/4480 batches | lr 0.00100000 | ms/batch 48.61 | loss  0.00 | mse 83.90 | mre 1957389.06 |mse_next 83.90 | mre_next 1957389.06 |cls  2.04 | pert  2.46 | ps  0.00 |gepc 85.01 |gepc_next 92.42 |
scGPT - INFO - | epoch   1 | 1800/4480 batches | lr 0.00100000 | ms/batch 48.33 | loss  0.00 | mse 82.97 | mre 1948421.81 |mse_next 82.97 | mre_next 1948421.81 |cls  2.04 | pert  2.24 | ps  0.00 |gepc 84.23 |gepc_next 89.97 |
scGPT - INFO - | epoch   1 | 1860/4480 batches | lr 0.00100000 | ms/batch 47.94 | loss  0.00 | mse 83.58 | mre 1965170.31 |mse_next 83.58 | mre_next 1965170.31 |cls  2.01 | pert  2.37 | ps  0.00 |gepc 84.45 |gepc_next 88.18 |
scGPT - INFO - | epoch   1 | 1920/4480 batches | lr 0.00100000 | ms/batch 47.87 | loss  0.00 | mse 83.38 | mre 1948037.62 |mse_next 83.38 | mre_next 1948037.62 |cls  2.01 | pert  2.37 | ps  0.00 |gepc 84.47 |gepc_next 85.89 |
scGPT - INFO - | epoch   1 | 1980/4480 batches | lr 0.00100000 | ms/batch 48.04 | loss  0.00 | mse 82.13 | mre 1939323.27 |mse_next 82.13 | mre_next 1939323.27 |cls  1.95 | pert  2.37 | ps  0.00 |gepc 83.40 |gepc_next 83.21 |
scGPT - INFO - | epoch   1 | 2040/4480 batches | lr 0.00100000 | ms/batch 48.17 | loss  0.00 | mse 82.76 | mre 1892831.66 |mse_next 82.76 | mre_next 1892831.66 |cls  1.99 | pert  2.33 | ps  0.00 |gepc 84.13 |gepc_next 82.71 |
scGPT - INFO - | epoch   1 | 2100/4480 batches | lr 0.00100000 | ms/batch 47.93 | loss  0.00 | mse 83.33 | mre 1941962.77 |mse_next 83.33 | mre_next 1941962.77 |cls  1.91 | pert  2.33 | ps  0.00 |gepc 83.92 |gepc_next 82.62 |
scGPT - INFO - | epoch   1 | 2160/4480 batches | lr 0.00100000 | ms/batch 47.95 | loss  0.00 | mse 82.62 | mre 1931238.96 |mse_next 82.62 | mre_next 1931238.96 |cls  1.82 | pert  2.31 | ps  0.00 |gepc 83.15 |gepc_next 81.73 |
scGPT - INFO - | epoch   1 | 2220/4480 batches | lr 0.00100000 | ms/batch 47.99 | loss  0.00 | mse 82.00 | mre 1919865.90 |mse_next 82.00 | mre_next 1919865.90 |cls  1.80 | pert  2.27 | ps  0.00 |gepc 82.39 |gepc_next 81.13 |
scGPT - INFO - | epoch   1 | 2280/4480 batches | lr 0.00100000 | ms/batch 48.33 | loss  0.00 | mse 81.33 | mre 1901858.98 |mse_next 81.33 | mre_next 1901858.98 |cls  1.73 | pert  2.33 | ps  0.00 |gepc 81.86 |gepc_next 80.59 |
